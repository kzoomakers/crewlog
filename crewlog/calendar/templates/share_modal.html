<div class="modal-header">
    <h5 class="modal-title">Share calendar {{ current_role().calendar.name }}</h5>
    <button aria-label="Close" class="close" data-dismiss="modal" type="button">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
<div class="modal-body" id="modal-body">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-danger" role="alert">"{{ message }}"</div>
    {% endfor %}
    {% endif %}
    {% endwith %}
    <form id="modalForm" onsubmit="return false">
        {{ form.hidden_tag() }}
        <div class="form-group">
            <label for="shareUrl">Share URL</label>
            <div class="input-group">
                <input class="form-control" id="shareUrl" name="url" placeholder="Select the permission first >"
                       readonly type="text">
                <div class="input-group-append" id="shareGroupRight">
                    <select aria-label="Example select with button addon" autofocus
                            class="custom-select" id="roleName" name="roleName"
                            onchange="newShare(modalForm, modal, '/api/v1/calendars/share')">
                        <option selected value="">...</option>
                        <option value="10">View</option>
                        <option value="50">Edit</option>
                    </select>
                    <button class="btn btn-success" data-content="Copied!" data-placement="top" data-toggle="popover"
                            id="buttonCopyShare" onclick="copyText(shareUrl)" style="display: none;" type="button">Copy
                        link
                    </button>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="expirationDays">Link expiration</label>
            <div class="input-group">
                <input class="form-control" id="expirationDays" name="expirationDays" type="number"
                       min="1" max="365" value="7" style="max-width: 100px;">
                <div class="input-group-append">
                    <span class="input-group-text">days</span>
                </div>
            </div>
            <div class="form-check mt-2">
                <input class="form-check-input" type="checkbox" id="noExpiration" name="noExpiration"
                       onchange="toggleExpirationDays()">
                <label class="form-check-label" for="noExpiration">
                    Link does not expire
                </label>
            </div>
            <small class="form-text text-muted" id="shareHelp">The link will be active for the specified number of days.</small>
        </div>
    </form>
    <script>
        function toggleExpirationDays() {
            var checkbox = document.getElementById('noExpiration');
            var daysInput = document.getElementById('expirationDays');
            daysInput.disabled = checkbox.checked;
            if (checkbox.checked) {
                document.getElementById('shareHelp').textContent = 'The link will never expire.';
            } else {
                document.getElementById('shareHelp').textContent = 'The link will be active for ' + daysInput.value + ' days.';
            }
        }
        
        document.getElementById('expirationDays').addEventListener('change', function() {
            if (!document.getElementById('noExpiration').checked) {
                document.getElementById('shareHelp').textContent = 'The link will be active for ' + this.value + ' days.';
            }
        });
    </script>
</div>
<div class="modal-footer">
    <button class="btn btn-secondary" data-dismiss="modal" type="button">Close</button>
</div>
